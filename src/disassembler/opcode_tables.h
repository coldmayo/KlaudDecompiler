#include <stdbool.h>
#include <stdio.h>

enum {
	AL, EAX, ES, CS, SS, DS, ONE, CL, XMM0, BND0, BAD, MM0,
	IMM8, IMM16, IMM32, REL8, REL32, PTR1632, R, RM,
	BYTE, WORD, DWORD, QWORD, FWORD, XMMWORD
};

typedef struct {
	bool hasModRM;   //modr/m ?
	char size;   // 
	const char *asmb;   //mnemonic
	uint8_t opcode;
	char arg_count;
	char arguments[4];
} Instruction;

static Instruction one_byte[255] = {
    {true, BYTE, "ADD ", 0x00, 2, {RM, R}},
    {true, DWORD, "ADD ", 0x01, 2, {RM, R}},
    {true, BYTE, "ADD ", 0x02, 2, {R, RM}},
    {true, DWORD, "ADD ", 0x03, 2, {R, RM}},
    {false, 0, "ADD ", 0x04, 2, {AL, IMM8}},
    {false, 0, "ADD ", 0x05, 2, {EAX, IMM32}},
    {false, 0, "PUSH ES", 0x06, 0, {0}},
    {false, 0, "POP ES", 0x07, 0, {0}},
    {true, BYTE, "OR ", 0x08, 2, {RM, R}},
    {true, DWORD, "OR ", 0x09, 2, {RM, R}},
    {true, BYTE, "OR ", 0x0A, 2, {RM, R}},
    {true, DWORD, "OR ", 0x0B, 2, {RM, R}},
    {false, 0, "OR ", 0x0C, 2, {AL, IMM8}},
    {false, 0, "OR ", 0x0D, 2, {EAX, IMM32}},
    {false, 0, "POP CS", 0x0E, 0, {0}},
    {true, BYTE, "ADC ", 0x10, 2, {RM, R}},
    {true, DWORD, "ADC ", 0x11, 2, {RM, R}},
    {true, BYTE, "ADC ", 0x12, 2, {R, RM}},
    {true, DWORD, "ADC ", 0x13, 2, {R, RM}},
    {false, 0, "ADC ", 0x14, 2, {AL, IMM8}},
    {false, 0, "ADC ", 0x15, 2, {EAX, IMM32}},
    {false, 0, "PUSH SS", 0x16, 0, {0}},
    {false, 0, "POP SS", 0x17, 0, {0}},
    {true, BYTE, "SBB ", 0x18, 2, {RM, R}},
    {true, DWORD, "SBB ", 0x19, 2, {RM, R}},
    {true, BYTE, "SBB ", 0x1A, 2, {R, RM}},
    {true, DWORD, "SBB ", 0x1B, 2, {R, RM}},
    {false, 0, "SBB ", 0x1C, 2, {AL, IMM8}},
    {false, 0, "SBB ", 0x1D, 2, {EAX, IMM32}},
    {false, 0, "PUSH DS", 0x1E, 0, {0}},
    {false, 0, "POP DS", 0x1F, 0, {0}},
    {true, BYTE, "AND ", 0x20, 2, {RM, R}},
    {true, DWORD, "AND ", 0x21, 2, {RM, R}},
    {true, BYTE, "AND ", 0x22, 2, {R, RM}},
    {true, DWORD, "AND ", 0x23, 2, {R, RM}},
    {false, 0, "AND ", 0x24, 2, {AL, IMM8}},
    {false, 0, "AND ", 0x25, 2, {EAX, IMM32}},
    {false, 0, "ES ", 0x26, 0, {0}},
    {false, 0, "DAA ", 0x27, 0, {0}},
    {true, BYTE, "SUB ", 0x28, 2, {RM, R}},
    {true, DWORD, "SUB ", 0x29, 2, {RM, R}},
    {true, BYTE, "SUB ", 0x2A, 2, {R, RM}},
    {true, DWORD, "SUB ", 0x2B, 2, {R, RM}},
    {false, 0, "SUB ", 0x2C, 2, {AL, IMM8}},
    {false, 0, "SUB ", 0x2D, 2, {EAX, IMM32}},
    {false, 0, "CS ", 0x2E, 0, {0}},
    {false, 0, " DAS ", 0x2F, 0, {0}},
    {true, BYTE, "XOR ", 0x30, 2, {RM, R}},
    {true, DWORD, "XOR ", 0x31, 2, {RM, R}},
    {true, BYTE, "XOR ", 0x32, 2, {R, RM}},
    {true, DWORD, "XOR ", 0x33, 2, {R, RM}},
    {false, 0, "XOR ", 0x34, 2, {AL, IMM8}},
    {false, 0, "XOR ", 0x35, 2, {EAX, IMM32}},
    {false, 0, "SS ", 0x36, 0, {0}},
    {false, 0, "AAA ", 0x37, 0, {0}},
    {true, BYTE, "CMP ", 0x38, 2, {RM, R}},
    {true, DWORD, "CMP ", 0x39, 2, {RM, R}},
    {true, BYTE, "CMP ", 0x3A, 2, {R, RM}},
    {true, DWORD, "CMP ", 0x3B, 2, {R, RM}},
    {false, 0, "CMP ", 0x3C, 2, {AL, IMM8}},
    {false, 0, "CMP ", 0x3D, 2, {EAX, IMM32}},
    {false, 0, "DS ", 0x3E, 0, {0}},
    {false, 0, "AAS ", 0x3F, 0, {0}},
    {false, 0, "INC EAX", 0x40, 0, {0}},
    {false, 0, "INC ECX", 0x41, 0, {0}},
    {false, 0, "INC EDX", 0x42, 0, {0}},
    {false, 0, "INC EBX", 0x43, 0, {0}},
    {false, 0, "INC ESP", 0x44, 0, {0}},
    {false, 0, "INC EBP", 0x45, 0, {0}},
    {false, 0, "INC ESI", 0x46, 0, {0}},
    {false, 0, "INC EDI", 0x47, 0, {0}},
    {false, 0, "DEC EAX", 0x48, 0, {0}},
    {false, 0, "DEC ECX", 0x49, 0, {0}},
    {false, 0, "DEC EDX", 0x4A, 0, {0}},
    {false, 0, "DEC EBX", 0x4B, 0, {0}},
    {false, 0, "DEC ESP", 0x4C, 0, {0}},
    {false, 0, "DEC EBP", 0x4D, 0, {0}},
    {false, 0, "INC ESI", 0x4E, 0, {0}},
    {false, 0, "INC EDI", 0x4F, 0, {0}},
    {false, 0, "PUSH EAX", 0x50, 0, {0}},
    {false, 0, "PUSH ECX", 0x51, 0, {0}},
    {false, 0, "PUSH EDX", 0x52, 0, {0}},
    {false, 0, "PUSH EBX", 0x53, 0, {0}},
    {false, 0, "PUSH ESP", 0x54, 0, {0}},
    {false, 0, "PUSH EBP", 0x55, 0, {0}},
    {false, 0, "PUSH ESI", 0x56, 0, {0}},
    {false, 0, "PUSH EDI", 0x57, 0, {0}},
    {false, 0, "POP EAX", 0x58, 0, {0}},
    {false, 0, "POP ECX", 0x59, 0, {0}},
    {false, 0, "POP EDX", 0x5A, 0, {0}},
    {false, 0, "POP EBX", 0x5B, 0, {0}},
    {false, 0, "POP ESP", 0x5C, 0, {0}},
    {false, 0, "POP EBP", 0x5D, 0, {0}},
    {false, 0, "POP ESI", 0x5E, 0, {0}},
    {false, 0, "POP EDI", 0x5F, 0, {0}},
    {false, 0, "PUSHA", 0x60, 0, {0}},
    {false, 0, "POPA", 0x61, 0, {0}},
    {true, QWORD, "BOUND ", 0x62, 2, {R, RM}},
    {true, WORD, "ARPL ", 0x63, 0, {RM, R}},
    {false, 0, "FS ", 0x64, 0, {0}},
    {false, 0, "GS ", 0x65, 0, {0}},
    {false, 0, "DATA16 ", 0x66, 0, {0}},
    {false, 0, "ADDR16 ", 0x67, 0, {0}},
    {false, 0, "PUSH ", 0x68, 1, {IMM32}},
    {true, DWORD, "IMUL ", 0x69, 3, {R, RM, IMM32}},
    {false, 0, "PUSH ", 0x6A, 1, {IMM8}},
    {true, DWORD, "IMUL ", 0x6B, 3, {R, RM, IMM8}},
    {false, 0, "INS BYTE PTR es:[edi],dx", 0x6C, 0, {0}},
	{false, 0, "INS DWORD PTR es:[edi],dx", 0x6D, 0, {0}},
	{false, 0, "OUTS dx,BYTE PTR ds:[esi]", 0x6E, 0, {0}},
	{false, 0, "OUTS dx,DWORD PTR ds:[esi]", 0x6F, 0, {0}},
	{false, 0, "JO ", 0x70, 1, {REL8}},
	{false, 0, "JNO ", 0x71, 1, {REL8}},
	{false, 0, "JB ", 0x72, 1, {REL8}},
	{false, 0, "JNB ", 0x73, 1, {REL8}},
	{false, 0, "JZ ", 0x74, 1, {REL8}},
	{false, 0, "JNZ ", 0x75, 1, {REL8}},
	{false, 0, "JBE ", 0x76, 1, {REL8}},
	{false, 0, "JNBE ", 0x77, 1, {REL8}},
	{false, 0, "JS ", 0x78, 1, {REL8}},
	{false, 0, "JNS ", 0x79, 1, {REL8}},
	{false, 0, "JP ", 0x7A, 1, {REL8}},
	{false, 0, "JNP ", 0x7B, 1, {REL8}},
	{false, 0, "JL ", 0x7C, 1, {REL8}},
	{false, 0, "JNL ", 0x7D, 1, {REL8}},
	{false, 0, "JLE ", 0x7E, 1, {REL8}},
	{false, 0, "JNLE ", 0x7F, 1, {REL8}},
	{true, BYTE, "ADD ", 0x80, 2, {RM, IMM8}},
	{true, DWORD, "ADD ", 0x81, 2, {RM, IMM32}},
	{false, 0, ".byte 0x82", 0x82, 0, {0}},
	{true, DWORD, "ADC ", 0x83, 2, {RM, IMM8}},
	{true, BYTE, "TEST ", 0x84, 2, {RM, R}},
	{true, DWORD, "TEST ", 0x85, 2, {RM, R}},
	{true, BYTE, "XCHG ", 0x86, 2, {RM, R}},
	{true, DWORD, "XCHG ", 0x87, 2, {RM, R}},
	{true, BYTE, "MOV ", 0x88, 2, {RM, R}},
	{true, DWORD, "MOV ", 0x89, 2, {RM, R}},
	{true, BYTE, "MOV ", 0x8A, 2, {R, RM}},
	{true, DWORD, "MOV ", 0x8B, 2, {R, RM}},
	{true, WORD, "MOV ", 0x8C, 2, {RM, SS}},
	{true, 0, "LEA ", 0x8D, 2, {R, RM}},
	{true, WORD, "MOV SS,", 0x8E, 1, {RM}},
	{true, DWORD, "POP ", 0x8F, 1, {RM}},
	{false, 0, "NOP", 0x90, 0, {0}},
	{false, 0, "XCHG ECX,EAX", 0x91, 0, {0}},
	{false, 0, "XCHG EDX,EAX", 0x92, 0, {0}},
	{false, 0, "XCHG EBX,EAX", 0x93, 0, {0}},
	{false, 0, "XCHG ESP,EAX", 0x94, 0, {0}},
	{false, 0, "XCHG EBP,EAX", 0x95, 0, {0}},
	{false, 0, "XCHG ESI,EAX", 0x96, 0, {0}},
	{false, 0, "XCHG EDI,EAX", 0x97, 0, {0}},
	{false, 0, "CWDE", 0x98, 0, {0}},
	{false, 0, "CDQ", 0x99, 0, {0}},
	{false, 0, "CALL ", 0x9A, 1, {PTR1632}},
	{false, 0, "FWAIT", 0x9B, 0, {0}},
	{false, 0, "PUSHF", 0x9C, 0, {0}},
	{false, 0, "POPF", 0x9D, 0, {0}},
	{false, 0, "SAHF", 0x9E, 0, {0}},
	{false, 0, "LAHF", 0x9F, 0, {0}},
	{false, 0, "MOV AL,DS:", 0xA0, 1, {IMM8}},
	{false, 0, "MOV EAX,DS:", 0xA1, 1, {IMM8}},
	{false, 0, "MOV DS:", 0xA2, 2, {IMM8, AL}},
	{false, 0, "MOV DS:", 0xA3, 2, {IMM32, EAX}},
	{false, 0, "MOVS BYTE PTR es:[edi],BYTE PTR ds:[esi]", 0xA4, 0, {0}},
	{false, 0, "MOVS DWORD PTR es:[edi],DWORD PTR ds:[esi]", 0xA5, 0, {0}},
	{false, 0, "CMPS BYTE PTR es:[esi],BYTE PTR ds:[edi]", 0xA6, 0, {0}},
	{false, 0, "CMPS DWORD PTR es:[esi],DWORD PTR ds:[edi]", 0xA7, 0, {0}},
	{false, 0, "TEST AL,", 0xA8, 1, {IMM8}},
	{false, 0, "TEST EAX,", 0xA9, 1, {IMM32}},
	{false, 0, "stos BYTE PTR es:[edi],al", 0xAA, 0, {0}},
	{false, 0, "stos DWORD PTR es:[edi],eax", 0xAB, 0, {0}},
	{false, 0, "lods al,BYTE PTR ds:[esi]", 0xAC, 0, {0}},
	{false, 0, "lods eax,DWORD PTR ds:[esi]", 0xAD, 0, {0}},
	{false, 0, "scas al,BYTE PTR es:[edi]", 0xAE, 0, {0}},
	{false, 0, "scas eax,DWORD PTR es:[edi]", 0xAF, 0, {0}},
	{false, 0, "MOV al,", 0xB0, 1, {IMM8}},
	{false, 0, "MOV cl,", 0xB1, 1, {IMM8}},
	{false, 0, "MOV dl", 0xB2, 1, {IMM8}},
	{false, 0, "MOV bl,", 0xB3, 1, {IMM8}},
	{false, 0, "MOV ah,", 0xB4, 1, {IMM8}},
	{false, 0, "MOV ch,", 0xB5, 1, {IMM8}},
	{false, 0, "MOV dh,", 0xB6, 1, {IMM8}},
	{false, 0, "MOV bh,", 0xB7, 1, {IMM8}},
	{false, 0, "MOV eax,", 0xB8, 1, {IMM32}},
	{false, 0, "MOV ecx,", 0xB9, 1, {IMM32}},
	{false, 0, "MOV edx,", 0xBA, 1, {IMM32}},
	{false, 0, "MOV ebx,", 0xBB, 1, {IMM32}},
	{false, 0, "MOV esp,", 0xBC, 1, {IMM32}},
	{false, 0, "MOV ebp,", 0xBD, 1, {IMM32}},
	{false, 0, "MOV esi,", 0xBE, 1, {IMM32}},
	{false, 0, "MOV edi,", 0xBF, 0, {IMM32}},
	{true, BYTE, "ROL ", 0xC0, 2, {RM, IMM8}},
	{true, DWORD, "ROL ", 0xC1, 2, {RM, IMM8}},
	{false, 0, "RET ", 0xC2, 1, {IMM16}},
	{false, 0, "RET ", 0xC3, 0, {0}},
	{true, FWORD, "LES EAX,", 0xC4, 1, {RM}},
	{true, FWORD, "LDS eax,", 0xC5, 1, {RM}},
	{true, BYTE, "MOV ", 0xC6, 2, {RM, IMM8}},
	{true, DWORD, "MOV ", 0xC7, 2, {RM, IMM32}},
	{false, 0, "ENTER ", 0xC8, 2, {IMM16, IMM8}},
	{false, 0, "LEAVE", 0xC9, 0, {0}},
	{false, 0, "RETF ", 0xCA, 1, {IMM16}},
	{false, 0, "RETF", 0xCB, 0, {0}},
	{false, 0, "INT3", 0xCC, 0, {0}},
	{false, 0, "INT ", 0xCD, 1, {IMM8}},
	{false, 0, "INTO", 0xCE, 0, {0}},
	{false, 0, "IRET", 0xCF, 0, {0}},
	{true, BYTE, "ROL ", 0xD0, 2, {RM, ONE}},
	{true, DWORD, "ROL ", 0xD1, 2, {RM, ONE}},
	{true, BYTE, "ROL ", 0xD2, 2, {R, CL}},
	{true, DWORD, "ROL ", 0xD3, 2, {R, CL}},
	{false, 0, "AAM ", 0xD4, 1, {IMM8}},
	{false, 0, "AAD ", 0xD5, 1, {IMM8}},
	{false, 0, ".BYTE 0xd6", 0xD6, 0, {0}},
	{false, 0, "xlat BYTE PTR ds:[ebx]", 0xD7, 0, {0}},
	{true, DWORD, "FADD ", 0xD8, 1, {RM}},
	{true, DWORD, "FLD ", 0xD9, 1, {RM}},
	{true, DWORD, "FIADD ", 0xDA, 1, {RM}},
	{true, DWORD, "FILD ", 0xDB, 1, {RM}},
	{true, QWORD, "FADD ", 0xDC, 1, {RM}},
	{true, QWORD, "FLD ", 0xDD, 1, {RM}},
	{true, WORD, "FIADD ", 0xDE, 1, {RM}},
	{true, WORD, "FILD ", 0xDF, 1, {RM}},
	{false, 0, "LOOPNE ", 0xE0, 1, {REL8}},
	{false, 0, "LOOPE ", 0xE1, 1, {REL8}},
	{false, 0, "LOOP ", 0xE2, 1, {REL8}},
	{false, 0, "JECXZ ", 0xE3, 1, {REL8}},
	{false, 0, "IN al,", 0xE4, 1, {IMM8}},
	{false, 0, "IN eax,", 0xE5, 1, {IMM8}},
	{false, 0, "OUT ", 0xE6, 2, {IMM8, AL}},
	{false, 0, "OUT ", 0xE7, 2, {IMM8, EAX}},
	{false, 0, "CALL ", 0xE8, 1, {REL32}},
	{false, 0, "JMP ", 0xE9, 1, {REL32}},
	{false, 0, "JMPF ", 0xEA, 1, {PTR1632}},
	{false, 0, "JMP ", 0xEB, 1, {REL8}},
	{false, 0, "IN al,dx", 0xEC, 0, {0}},
	{false, 0, "IN eax,dx", 0xED, 0, {0}},
	{false, 0, "out dx,al", 0xEE, 0, {0}},
	{false, 0, "out dx,eax", 0xEF, 0, {0}},
	{false, 0, "LOCK ", 0xF0, 0, {0}},
	{false, 0, "ICEBP", 0xF1, 0, {0}},
	{false, 0, "REPNZ ", 0xF2, 0, {0}},
	{false, 0, "REPZ ", 0xF3, 0, {0}},
	{false, 0, "HLT", 0xF4, 0, {0}},
	{false, 0, "CMC", 0xF5, 0, {0}},
	{true, BYTE, "TEST ", 0xF6, 2, {RM, IMM8}},
	{true, DWORD, "TEST ", 0xF7, 2, {RM, IMM32}},
	{false, 0, "CLC", 0xF8, 0, {0}},
	{false, 0, "STC", 0xF9, 0, {0}},
	{false, 0, "CLI", 0xFA, 0, {0}},
	{false, 0, "STI", 0xFB, 0, {0}},
	{false, 0, "CLD", 0xFC, 0, {0}},
	{false, 0, "STD", 0xFD, 0, {0}},
	{true, BYTE, "INC ", 0xFE, 1, {RM}},
	{true, DWORD, "INC ", 0xFF, 1, {RM}}
};

static Instruction two_byte[255] = {
    {true, WORD, "SLLDT ", 0x00, 1, {RM}},
    {true, 0, "SGDTD ", 0x01, 1, {RM}}, 
    {true, 0, "LAR eax,WORD PTR ", 0x02, 1, {RM}},
    {true, 0, "LSL eax,WORD PTR ", 0x03, 1, {RM}},
    {false, 0, ".word 0x0f04", 0x04, 0, {0}},
    {false, 0, "SYSCALL", 0x05, 0, {0}},
    {false, 0, "CLTS", 0x06, 0, {0}},
    {false, 0, "SYSRET", 0x07, 0, {0}},
    {false, 0, "INVD", 0x08, 0, {0}},
    {false, 0, "WBINVD", 0x09, 0, {0}},
    {false, 0, ".word 0x0f0a", 0x0A, 0, {0}},
    {false, 0, "UD2", 0x0B, 0, {0}},
    {true, BYTE, "prefetch", 0x0D, 1, {RM}},
    {false, 0, ".word 0x0f0c", 0x0C, 0, {0}},
    {true, 0, "FEMMS", 0x0E, 0, {0}},
    {true, XMMWORD, "MOVUPS xmm0,", 0x10, 1, {RM}},
    {true, XMMWORD, "MOVUPS ", 0x11, 2, {RM, XMM0}},
    {true, QWORD, "MOVLPS xmm0,", 0x12, 1, {RM}},
    {true, QWORD, "MOVLPS ", 0x13, 2, {RM, XMM0}},
    {true, XMMWORD, "UNPCKLPS xmm0,", 0x14, 1, {RM}},
    {true, XMMWORD, "UNPCKHPS xmm0,", 0x15, 1, {RM}},
    {true, QWORD, "MOVHPS xmm0,", 0x16, 1, {RM}},
    {true, QWORD, "MOVHPS ", 0x17, 2, {RM, XMM0}},
    {true, BYTE, "PREFETCHNTA ", 0x18, 1, {RM}},
    {true, DWORD, "NOP ", 0x19, 1, {RM}},
    {true, 0, "BNDLDX bnd0,", 0x1A, 1, {RM}},
	{true, 0, "BNDSTX ", 0x1B, 2, {RM, BND0}},
	{true, DWORD, "NOP ", 0x1C, 1, {RM}},
	{true, DWORD, "NOP ", 0x1D, 1, {RM}},
	{true, DWORD, "NOP ", 0x1E, 1, {RM}},
	{true, DWORD, "NOP ", 0x1F, 1, {RM}},
	{false, 0, ".word 0x0f20", 0x20, 0, {0}},
	{false, 0, ".word 0x0f21", 0x21, 0, {0}},
	{false, 0, ".word 0x0f22", 0x22, 0, {0}},
	{false, 0, ".word 0x0f23", 0x23, 0, {0}},
	{false, 0, ".word 0x0f24", 0x24, 0, {0}},
	{false, 0, ".word 0x0f25", 0x25, 0, {0}},
	{false, 0, ".word 0x0f26", 0x26, 0, {0}},
	{false, 0, ".word 0x0f27", 0x27, 0, {0}},
	{true, XMMWORD, "MOVAPS xmm0,", 0x28, 1, {RM}},
	{true, XMMWORD, "MOVAPS ", 0x29, 2, {RM, XMM0}},
	{true, QWORD, "CVTPI2PS xmm0,", 0x2A, 1, {RM}},
	{true, XMMWORD, "MOVNTPS ", 0x2B, 2, {RM, XMM0}},
	{true, QWORD, "CVTTPS2PI mm0,", 0x2C, 1, {RM}},
	{true, QWORD, "CVTPS2PI mm0,", 0x2D, 1, {RM}},
	{true, DWORD, "UCOMISS xmm0,", 0x2E, 1, {RM}},
	{true, DWORD, "COMISS xmm0,", 0x2F, 1, {RM}},
	{false, 0, "wrmsr", 0x30, 0, {0}},
	{false, 0, "rdtsc", 0x31, 0, {0}},
	{false, 0, "rdmsr", 0x32, 0, {0}},
	{false, 0, "rdpmc", 0x33, 0, {0}},
	{false, 0, "sysenter", 0x34, 0, {0}},
	{false, 0, "sysexit", 0x35, 0, {0}},
	{false, 0, ".word 0x0f36", 0x36, 0, {0}},
	{false, 0, "getsec", 0x37, 0, {0}},
	{true, QWORD, "PSHUFB mm0,", 0x38, 1, {RM}},
	{false, 0, ".word 0x0f39", 0x39, 0, {0}},
	{false, 0, "(bad)", 0x3A, 1, {BAD}},
	{false, 0, ".word 0x0f3b", 0x3B, 0, {0}},
	{false, 0, ".word 0x0f3c", 0x3C, 0, {0}},
	{false, 0, ".word 0x0f3d", 0x3D, 0, {0}},
	{false, 0, ".word 0x0f3e", 0x3E, 0, {0}},
	{false, 0, ".word 0x0f3f", 0x3F, 0, {0}},
	{true, DWORD, "CMOVO ", 0x40, 2, {R, RM}},
	{true, DWORD, "CMOVNO ", 0x41, 2, {R, RM}},
	{true, DWORD, "CMOVB ", 0x42, 2, {R, RM}},
	{true, DWORD, "CMOVAE ", 0x43, 2, {R, RM}},
	{true, DWORD, "CMOVE ", 0x44, 2, {R, RM}},
	{true, DWORD, "CMOVNE ", 0x45, 2, {R, RM}},
	{true, DWORD, "CMOVBE ", 0x46, 2, {R, RM}},
	{true, DWORD, "CMOVA ", 0x47, 2, {R, RM}},
	{true, DWORD, "CMOVS ", 0x48, 2, {R, RM}},
	{true, DWORD, "CMOVNS ", 0x49, 2, {R, RM}},
	{true, DWORD, "CMOVP ", 0x4A, 2, {R, RM}},
	{true, DWORD, "CMOVNP ", 0x4B, 2, {R, RM}},
	{true, DWORD, "CMOVL ", 0x4C, 2, {R, RM}},
	{true, DWORD, "CMOVGE ", 0x4D, 2, {R, RM}},
	{true, DWORD, "CMOVLE ", 0x4E, 2, {R, RM}},
	{true, DWORD, "CMOVG ", 0x4F, 2, {R, RM}},
	{false, 0, ".word 0x0f50", 0x50, 0, {0}},
	{true, XMMWORD, "sqrtps xmm0,", 0x51, 1, {RM}},
	{true, XMMWORD, "rsqrtps xmm0,", 0x52, 1, {RM}},
	{true, XMMWORD, "rcpps xmm0,", 0x53, 1, {RM}},
	{true, XMMWORD, "andps xmm0,", 0x54, 1, {RM}},
	{true, XMMWORD, "andnps xmm0,", 0x55, 1, {RM}},
	{true, XMMWORD, "orps xmm0,", 0x56, 1, {RM}},
	{true, XMMWORD, "xorps xmm0,", 0x57, 1, {RM}},
	{true, XMMWORD, "addps xmm0,", 0x58, 1, {RM}},
	{true, XMMWORD, "mulps xmm0,", 0x59, 1, {RM}},
	{true, QWORD, "CVTPS2PD xmm0,", 0x5A, 1, {RM}},
	{true, XMMWORD, "CVTDP2PS xmm0,", 0x5B, 1, {RM}},
	{true, XMMWORD, "SUBPS xmm0,", 0x5C, 1, {RM}},
	{true, XMMWORD, "MINPS xmm0,", 0x5D, 1, {RM}},
	{true, XMMWORD, "DIVPS xmm0,", 0x5E, 1, {RM}},
	{true, XMMWORD, "MAXPS xmm0,", 0x5F, 1, {RM}},
	{true, DWORD, "punpcklbw mm0,", 0x60, 1, {RM}},
	{true, DWORD, "punpcklwd mm0,", 0x61, 1, {RM}},
	{true, DWORD, "punpckldq mm0,", 0x62, 1, {RM}},
	{true, QWORD, "packsswb mm0,", 0x63, 1, {RM}},
	{true, QWORD, "pcmpgtb mm0,", 0x64, 1, {RM}},
	{true, QWORD, "pcmpgtw mm0,", 0x65, 1, {RM}},
	{true, QWORD, "pcmpgtd mm0,", 0x66, 1, {RM}},
	{true, QWORD, "packuswb mm0,", 0x67, 1, {RM}},
	{true, QWORD, "punpckhbw mm0,", 0x68, 1, {RM}},
	{true, QWORD, "punpckhwd mm0,", 0x69, 1, {RM}},
	{true, QWORD, "punpckhdq mm0,", 0x6A, 1, {RM}},
	{true, QWORD, "packssdw mm0,", 0x6B, 1, {RM}},
	{false, 0, ".word 0x0f6c", 0x6C, 0, {0}},
	{false, 0, ".word 0x0f6d", 0x6D, 0, {0}},
	{true, DWORD, "movd mm0,", 0x6E, 1, {RM}},
	{true, QWORD, "movq mmo,", 0x6F, 1, {RM}},
	{true, QWORD, "pshufw mm0,", 0x70, 2, {RM, IMM8}},
	{false, 0, ".word 0x0f71", 0x71, 0, {0}},
	{false, 0, ".word 0x0f72", 0x72, 0, {0}},
	{false, 0, ".word 0x0f73", 0x73, 0, {0}},
	{true, QWORD, "pcmpeqb mm0,", 0x74, 1, {RM}},
	{true, QWORD, "pcmpeqw mm0,", 0x75, 1, {RM}},
	{true, QWORD, "pcmpeqd mm0,", 0x76, 1, {RM}},
	{false, 0, "EMMS", 0x77, 0, {0}},
	{true, DWORD, "VMREAD ", 0x78, 2, {RM, R}},
	{true, DWORD, "VMWRITE ", 0x79, 2, {RM, R}},
	{false, 0, "(bad)", 0x7A, 1, {BAD}},
	{false, 0, ".word 0x0f7b", 0x7B, 0, {0}},
	{false, 0, ".word 0x0f7c", 0x7C, 0, {0}},
	{false, 0, ".word 0x0f7d", 0x7D, 0, {0}},
	{true, DWORD, "MOVD ", 0x7E, 2, {RM, MM0}},
	{true, QWORD, "MOVQ ", 0x7F, 2, {RM, MM0}},
	{false, 0, "JO ", 0x80, 1, {REL32}},
	{false, 0, "JNO ", 0x81, 1, {REL32}},
	{false, 0, "JB ", 0x82, 1, {REL32}},
	{false, 0, "JAE ", 0x83, 1, {REL32}},
	{false, 0, "JE ", 0x84, 1, {REL32}},
	{false, 0, "JNE ", 0x85, 1, {REL32}},
	{false, 0, "JBE ", 0x86, 1, {REL32}},
	{false, 0, "JA ", 0x87, 1, {REL32}},
	{false, 0, "JS ", 0x88, 1, {REL32}},
	{false, 0, "JNS ", 0x89, 1, {REL32}},
	{false, 0, "JP ", 0x8A, 1, {REL32}},
	{false, 0, "JNP ", 0x8B, 1, {REL32}},
	{false, 0, "JL ", 0x8C, 1, {REL32}},
	{false, 0, "JGE ", 0x8D, 1, {REL32}},
	{false, 0, "JLE ", 0x8E, 1, {REL32}},
	{false, 0, "JG ", 0x8F, 1, {REL32}},
	{true, BYTE, "SETO ", 0x90, 1, {RM}},
	{true, BYTE, "SETNO ", 0x91, 1, {RM}},
	{true, BYTE, "SETB ", 0x92, 1, {RM}},
	{true, BYTE, "SETAE ", 0x93, 1, {RM}},
	{true, BYTE, "SETE ", 0x94, 1, {RM}},
	{true, BYTE, "SETNE ", 0x95, 1, {RM}},
	{true, BYTE, "SETBE ", 0x96, 1, {RM}},
	{true, BYTE, "SETA ", 0x97, 1, {RM}},
	{true, BYTE, "SETS ", 0x98, 1, {RM}},
	{true, BYTE, "SETNS ", 0x99, 1, {RM}},
	{true, BYTE, "SETP ", 0x9A, 1, {RM}},
	{true, BYTE, "SETNP ", 0x9B, 1, {RM}},
	{true, BYTE, "SETL ", 0x9C, 1, {RM}},
	{true, BYTE, "SETGE ", 0x9D, 1, {RM}},
	{true, BYTE, "SETLE ", 0x9E, 1, {RM}},
	{true, BYTE, "SETG ", 0x9F, 1, {RM}},
	{false, 0, "PUSH FS", 0xA0, 0, {0}},
	{false, 0, "POP FS", 0xA1, 0, {0}},
	{false, 0, "CPUID", 0xA2, 0, {0}},
	{true, DWORD, "BTS ", 0xA3, 2, {RM, R}},
	{true, DWORD, "SHLD ", 0xA4, 3, {RM, R, IMM8}},
	{true, DWORD, "SHLD ", 0xA5, 3, {RM, R, CL}},
	{false, 0, "PUSH GS", 0xA8, 0, {0}},
	{false, 0, "POP GS", 0xA9, 0, {0}},
	{false, 0, "RSM", 0xAA, 0, {0}},
	{true, DWORD, "BTS ", 0xAB, 2, {RM, R}},
	{true, DWORD, "SHRD ", 0xAC, 3, {RM, R, IMM8}},
	{true, DWORD, "SHRD ", 0xAD, 3, {RM, R, CL}},
	{true, 0, "FXSAVE ", 0xAE, 1, {RM}},
	{true, DWORD, "IMUL ", 0xAF, 2, {R, RM}},
	{true, BYTE, "CMPXCHG ", 0xB0, 2, {RM, AL}},
	{true, DWORD, "CMPXCHG ", 0xB1, 2, {RM, R}},
	{true, FWORD, "LSS ", 0xB2, 2, {R, RM}},
	{true, DWORD, "BTR ", 0xB3, 2, {RM, R}},
	{true, FWORD, "LFS ", 0xB4, 2, {R, RM}},
	{true, FWORD, "LGS ", 0xB5, 2, {R, RM}},
	{true, BYTE, "MOVZX ", 0xB6, 2, {R, RM}},
	{true, WORD, "MOVZX ", 0xB7, 2, {R, RM}},
	{false, 0, ".word 0x0fb8", 0xB8, 0, {0}},
	{false, 0, "UD1", 0xB9, 0, {0}},
	{false, 0, ".word 0x0fba", 0xBA, 0, {0}},
	{true, DWORD, "btc ", 0xBB, 2, {RM, R}},
	{true, DWORD, "bsf ", 0xBC, 2, {R, RM}},
	{true, DWORD, "bsr ", 0xBD, 2, {R, RM}},
	{true, BYTE, "movsx ", 0xBE, 2, {R, RM}},
	{true, WORD, "movsx ", 0xBF, 2, {R, RM}},
	{true, BYTE, "xadd ", 0xC0, 2, {RM, R}},
	{true, DWORD, "xadd ", 0xC1, 2, {RM, R}},
	{true, XMMWORD, "cmpeqps xmm0,", 0xC2, 1, {RM}},
	{true, QWORD, "movnti ", 0xC3, 2, {RM, R}},
	{true, WORD, "PINSRW mm0,", 0xC4, 2, {RM, IMM8}},
	{true, 0, "PEXTRW ", 0xC5, 3, {R, MM0, IMM8}},
	{true, XMMWORD, "shufps xmm0,", 0xC6, 2, {RM, IMM8}},
	{false, 0, ".word 0x0fc7", 0xC7, 0, {0}},
	{false, 0, "bswap eax", 0xC8, 0, {0}},
	{false, 0, "bswap ecx", 0xC9, 0, {0}},
	{false, 0, "bswap edx", 0xCA, 0, {0}},
	{false, 0, "bswap ebx", 0xCB, 0, {0}},
	{false, 0, "bswap esp", 0xCC, 0, {0}},
	{false, 0, "bswap ebp", 0xCD, 0, {0}},
	{false, 0, "bswap esi", 0xCE, 0, {0}},
	{false, 0, "bswap edi", 0xCF, 0, {0}},
	{false, 0, ".word 0x0fd0", 0xD0, 0, {0}},
	{false, QWORD, "psrlw mm0,", 0xD1, 1, {RM}},
	{true, QWORD, "psrld mm0,", 0xD2, 1, {RM}},
	{true, QWORD, "psrlq mm0,", 0xD3, 1, {RM}},
	{true, QWORD, "paddq mm0,", 0xD4, 1, {RM}},
	{true, QWORD, "pmullw mm0,", 0xD5, 1, {RM}},
	{false, 0, ".word 0x0fd6,", 0xD6, 0, {0}},
	{false, 0, ".word 0x0fd7,", 0xD7, 0, {0}},
	{true, QWORD, "psubusb mm0,", 0xD8, 1, {RM}},
	{true, QWORD, "psubusw mm0,", 0xD9, 1, {RM}},
	{true, QWORD, "pminub mm0,", 0xDA, 1, {RM}},
	{true, QWORD, "pand mm0,", 0xDB, 1, {RM}},
	{true, QWORD, "paddusb mm0,", 0xDC, 1, {RM}},
	{true, QWORD, "psubusw mm0,", 0xDD, 1, {RM}},
	{true, QWORD, "pmaxub mm0,", 0xDE, 1, {RM}},
	{true, QWORD, "pandn mm0,", 0xDF, 1, {RM}},
	{true, QWORD, "pavgb mm0,", 0xE0, 1, {RM}},
	{true, QWORD, "psraw mm0,", 0xE1, 1, {RM}},
	{true, QWORD, "psrad mm0,", 0xE2, 1, {RM}},
	{true, QWORD, "pavgw mm0,", 0xE3, 1, {RM}},
	{true, QWORD, "pmulhuw mm0,", 0xE4, 1, {RM}},
	{true, QWORD, "pmulhw mm0,", 0xE5, 1, {RM}},
	{false, 0, ".word 0x0fe6", 0xE6, 0, {0}},
	{true, QWORD, "movntq ", 0xE7, 2, {RM, MM0}},
	{true, QWORD, "psubsb mm0,", 0xE8, 1, {RM}},
	{true, QWORD, "psubsw mm0,", 0xE9, 1, {RM}},
	{true, QWORD, "pminsw mm0,", 0xEA, 1, {RM}},
	{true, QWORD, "por mm0,", 0xEB, 1, {RM}},
	{true, QWORD, "paddsb mm0,", 0xEC, 1, {RM}},
	{true, QWORD, "paddsw mm0,", 0xED, 1, {RM}},
	{true, QWORD, "pmaxsw mm0,", 0xEE, 1, {RM}},
	{true, QWORD, "pxor mm0,", 0xEF, 1, {RM}},
	{false, 0, ".word 0x0ff0", 0xF0, 0, {0}},
	{true, QWORD, "psllow mm0,", 0xF1, 1, {RM}},
	{true, QWORD, "pslld mm0,", 0xF2, 1, {RM}},
	{true, QWORD, "psllq mm0,", 0xF3, 1, {RM}},
	{true, QWORD, "pmuludq mm0,", 0xF4, 1, {RM}},
	{true, QWORD, "pmaddwd mm0,", 0xF5, 1, {RM}},
	{true, QWORD, "psadbw mm0,", 0xF6, 1, {RM}},
	{true, QWORD, "psubb mm0,", 0xF8, 1, {RM}},
	{true, QWORD, "psubw mm0,", 0xF9, 1, {RM}},
	{true, QWORD, "psubd mm0,", 0xFA, 1, {RM}},
	{true, QWORD, "psubq mm0,", 0xFB, 1, {RM}},
	{true, QWORD, "paddb mm0,", 0xFC, 1, {RM}},
	{true, QWORD, "paddw mm0,", 0xFD, 1, {RM}},
	{true, QWORD, "paddd mm0,", 0xFE, 1, {RM}},
};
